#!/bin/bash

LOC="/etc/pki/ca-trust/source/anchors"

ROOT='-----BEGIN CERTIFICATE-----
MIIF6TCCA9GgAwIBAgIQJMOttWuBOoVBKEPpgSg8xTANBgkqhkiG9w0BAQsFADAu
MSwwKgYDVQQDEyNCb3lzdG93biBSb290IENlcnRpZmljYXRlIEF1dGhvcml0eTAe
Fw0xNjA4MzAxMzUwMDhaFw0zNjA4MzAxNDAwMDZaMC4xLDAqBgNVBAMTI0JveXN0
b3duIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9yaXR5MIICIjANBgkqhkiG9w0BAQEF
AAOCAg8AMIICCgKCAgEAoSQ0DXTIrM2GxrcUsUqya+LgzCtxUGU8RuHbIf2/MLU+
q/KzW0IS9VLHhkZ38DYa9eSyn7I8m7SfoYtjNOi8wTS9rWxEHyFT0g4dFTxxS7F1
A2E6oUyeqFZf+Nkota8f6VYI4glB+LL4SxU3XIQK2xPPB5xmJ9kMeQMiiOC13DWg
EQ3loOc9ar7Ywcr18CrZPMOzQcWOc2w7tjKOMZmyt/KpELfow8qv15ti1m9PTlyG
f1+Uit1dHUWKlb0fGEuUIDXUlOb+GpOPql6+n5In5yFXjOs2toS4zxqfK3feGoph
OiHn6A4WqD3b7/zTX3P0K0S7dkQEjcGJTGXIjD2HHqdIo4MrNiSRnmFB+VHuivoh
5wXmHYKihxlvkrtvivfGLTCyaJ5E0JtglFGH8gNxmR02+YYUUAU6dCmHDcmRcLnN
ibIQ7w+uIEn54ms35LAo0gTdjjogCJPc82KTrWv9lMROA4iRl7Ic5PYj0SRzHArX
q3E0dpKuuUBculchVrV3B1mK0Tws6Ue3sSiAuET+mTcwWjxFHp0bJ5D954ZUzml9
19Yr7qOADkKRfYgOJn8LMYR7ufoSTb46H8EZAxhobVlmyLGILFVy7aQYlZZ1B7Ql
uNYBpoJdyxuW42AzzWUAid09mLl+QytQl7QEr5fQe9Giyg+pBOTbqDb7+qr2U6cC
AwEAAaOCAQEwgf4wCwYDVR0PBAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0O
BBYEFCHsOveEfprt8aDpn6xLoSADJYBlMBAGCSsGAQQBgjcVAQQDAgEAMIGsBgNV
HSAEgaQwgaEwgZ4GDGCGSAHF80tJg30DATCBjTBeBggrBgEFBQcCAjBSHlAAQgBv
AHkAcwAgAFQAbwB3AG4AIABDAGUAcgB0AGkAZgBpAGMAYQB0AGUAIABQAHIAYQBj
AHQAaQBjAGUAIABTAHQAYQB0AGUAbQBlAG4AdDArBggrBgEFBQcCARYfaHR0cDov
L0JUQ2VydC5ib3lzdG93bi5vcmcvY3BzADANBgkqhkiG9w0BAQsFAAOCAgEAZ8RF
wUWL7ouaN5MBc6f6CWSqbOvvmZlfvb2XRx3JR073Kmo019ntcUeWHFT6bevRAgpr
sUW1UEQkUfiHGcDCYKGBfYa0mpUKBexalS7bCiif69i1TCwLf/vYrAmbA9rm9n8S
lTqh7vtpFjBd3rapkFZiKGHV+dzcL+GTYeIwg5tcnvcFYlHqpboAMssgMrOgE2Yv
FVe2wuMvUB5Xc2Xqys8QJwdMEdMNFDnH46Rf90fWfj/6VVhsr9eDZiX1g6IxwmrH
GMfMeYktbhYdu07HTWJMuJKkI0tbgU/0hOFT4dpPYCBkskL9c/KPI10Y/bBmfN3Z
laei9Kt/5zwgz7a/05aqRanZVdAPEee+6Q/4M5epsFHJdJmCSI5UFP21035nUjjh
TLvxo02Gg3cENjdrDuGgNfMqkDiRza/Sc7JkiBurIPmllBtpVB+THgJ9U3eyijCW
VxPJ08sFBsHrCDRBRc24+ef/pO/KlFqZEWGOsN+QFl2XSfsFAuaJVqNeDyX3ela3
DX14n3AzNaPYzXvOGA6Jh9KKARIkipx4GA0fn6+CLLbyoL0OdZuj3OwUS5HRyqHs
lExAMErfuQWAZAvH1/XvGKepl8VgjFx96x5oZsX37++vWCh8O7xN2xmyBXIjPW+U
Hl5rqLfbsCilEqYY8CQt9ktkUZ8Bqo3Hyolba0Y=
-----END CERTIFICATE-----
'

INTER='-----BEGIN CERTIFICATE-----
MIIG2zCCBMOgAwIBAgITHwAAAAKJXAHJNlvQggAAAAAAAjANBgkqhkiG9w0BAQsF
ADAuMSwwKgYDVQQDEyNCb3lzdG93biBSb290IENlcnRpZmljYXRlIEF1dGhvcml0
eTAeFw0xNjA4MzAxNDE5MzVaFw0yNjA4MzAxNDI5MzVaMGAxEzARBgoJkiaJk/Is
ZAEZFgNvcmcxGDAWBgoJkiaJk/IsZAEZFghib3lzdG93bjEvMC0GA1UEAxMmQm95
c3Rvd24gSXNzdWluZyBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggEiMA0GCSqGSIb3
DQEBAQUAA4IBDwAwggEKAoIBAQDmOPkTIUfwoxWLDWMFqzyS66m/p+oYJO3VP3zz
+SSrwDgaNapgLCW2PZ1O8BzOkNcsS/vy3+q0Pz5sIuF+LQ6XEzmRG4ISWpHTFhZz
fs5sh21Fl81si11leGb1bhGF1lFDSF8ifTgihs7lHOwB4sb28E3xPKfgYutpAp9Y
aIQuRpvCwO2PKTN5HI2RL/MdNssROrPyHYGKdjvh3zk6yVGCiS8Db7XZVgamYvaC
C0oH53VhjVG00uSg1dPoBJY3cgtBK2TcHYGwpFZcvjaFKpgtT3r0EdRlWFtkArCx
53evh0EIlR2FGg+mGNGIpzWRlknbbE+miWGBjiND154NZyT1AgMBAAGjggK+MIIC
ujAQBgkrBgEEAYI3FQEEAwIBADAdBgNVHQ4EFgQUhYGEcbKu9NJewi54l8USBobz
l00wgbAGA1UdIASBqDCBpTCBogYMYIZIAcXzS0mDfQMBMIGRMF4GCCsGAQUFBwIC
MFIeUABCAG8AeQBzACAAVABvAHcAbgAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAg
AFAAcgBhAGMAdABpAGMAZQAgAFMAdABhAHQAZQBtAGUAbgB0MC8GCCsGAQUFBwIB
FiNodHRwOi8vQ2VydFBvbGljeS5ib3lzdG93bi5vcmcvY3BzADAZBgkrBgEEAYI3
FAIEDB4KAFMAdQBiAEMAQTALBgNVHQ8EBAMCAYYwDwYDVR0TAQH/BAUwAwEB/zAf
BgNVHSMEGDAWgBQh7Dr3hH6a7fGg6Z+sS6EgAyWAZTCBsQYDVR0fBIGpMIGmMIGj
oIGgoIGdhkxodHRwOi8vQlRDZXJ0LmJveXN0b3duLm9yZy9DUkwvQm95c3Rvd24l
MjBSb290JTIwQ2VydGlmaWNhdGUlMjBBdXRob3JpdHkuY3Jshk1odHRwOi8vQlRD
ZXJ0Mi5ib3lzdG93bi5vcmcvQ1JML0JveXN0b3duJTIwUm9vdCUyMENlcnRpZmlj
YXRlJTIwQXV0aG9yaXR5LmNybDCBxQYIKwYBBQUHAQEEgbgwgbUwWAYIKwYBBQUH
MAKGTGh0dHA6Ly9CVENlcnQuYm95c3Rvd24ub3JnL0NSTC9Cb3lzdG93biUyMFJv
b3QlMjBDZXJ0aWZpY2F0ZSUyMEF1dGhvcml0eS5jcnQwWQYIKwYBBQUHMAKGTWh0
dHA6Ly9CVENlcnQyLmJveXN0b3duLm9yZy9DUkwvQm95c3Rvd24lMjBSb290JTIw
Q2VydGlmaWNhdGUlMjBBdXRob3JpdHkuY3J0MA0GCSqGSIb3DQEBCwUAA4ICAQBg
eAlSMRsRYkXWjt2fgfYP3I0uGuBKOvzskJGY6Qj8FVcSSWicwjB06pZSpfiukwLt
VE9NrLfoWCJAHGoRJLfRx2Zk8U+OJy/vJ042EH+tAryqkjZcJQ6H6NC34zR+L4q2
LV0WihU5GxMh3BqBAZSeVUEY1UlXiOzzLxYWltej/dgBN74LHJIZr5jRaqcFm7Jv
pBPdinhcGjUhxUS6JOk51B1jn/4VeSMGxWKm5eW/Pxm/UVqrGAG20kVocDMB1iZf
v4fB0ASpHfqBDyUYxp8FdOqyw+IZ5f9Qota+TwevqW/i071gy+5O62uhBDPBcKpF
kbcglR3o1qZ5VJFr//lIBP3H7jClqU9cVDCP55eTAzXeZ+kECLfGtSWHjT4rm12K
60q+DmC7J7ZemqX53R3pRye8YL7n1jOeZnKz6egaLlNMyGabXA0ZqhSmQq3IJHXS
j49GOhAZ4wWza7241KuHG4tGWV4Rzm9gdJWYI1xEdqoEoQ0PmV18Z3FkaD2I7HR5
JxnIzzjW7V8Dop8x15YdG41GCH8PHFi2EK/wqH7/w2NDTRig+aCGDoqWE78h850g
2LrpejDcs9uShuI89j69JXMcAvfxjO5IIf2FS6xn6U2pKfxG2i+WwSKOiKWImWym
XRAfH+HPrtL4CaA/VbSx5eNOlfcQAFt2uPxPmg4LLg==
-----END CERTIFICATE-----
'

if [ "$ACTION" == "harden" ]; then
   if [ ! -s ${LOC}/bt_root.crt ] || [ ! -s  ${LOC}/bt_inter.crt ]; then
      if [ ! -s ${LOC}/bt_root.crt ]; then
         echo "$ROOT" > ${LOC}/bt_root.crt
      fi
      if [ ! -s  ${LOC}/bt_inter.crt ]; then
         echo "$INTER" > ${LOC}/bt_inter.crt
      fi
      update-ca-trust
   fi
fi

if [ ! -s ${LOC}/bt_root.crt ] || [ ! -s  ${LOC}/bt_inter.crt ]; then
   echo "FAIL"
   exit 1
else
   echo "PASS"
   exit 0
fi
